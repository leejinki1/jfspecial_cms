<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- jquery -->
<% include("/template/includes/jquery.html"){} %>
<% include("/template/includes/ueditor.html"){} %>

<script type="text/javascript">
	var ue;
	$(document).ready(function(){
		ue = UE.getEditor('editor',{
			initialFrameHeight:350  //初始化编辑器高度,默认320
			,compressSide:1
			,imageScaleEnabled:false // 图片不允许拖拽
       		, toolbars: [[
                       'source', '|',
                      'bold', 'italic', 'underline', 'strikethrough', 'insertorderedlist', 'insertunorderedlist', 'paragraph', '|',
                      'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|',
                      'link', 'unlink', '|',
                      'simpleupload', 'insertimage', 'emotion' , 'insertcode'
                  ]]
		});

	});
function oper_publish(id) {
		var albumId = $('[name="model.album_id"]').val();
		if(albumId=='-1') {
			Alert('请选择栏目');
			return false;
		}

		var title = $('[name="model.name"]').val();
		if(title=='') {
			Alert('请输入文章题目');
			return false;
		}
		if(title.length > 80 ) {
			Alert('文章（'+title.length+'字）题目过长，请输入小于80个字');
			return false;
		}

		if(!ue.hasContents()){
			Alert('请输入文章内容');
			return false;
		}
		if(ue.getContentTxt().length > 1200){
			Alert('文章（'+ue.getContentTxt().length+'字）文字过长，请输入小于1200个字');
			return false;
		}

		jQuery.ajax({
			type:'POST',
			url:'sale_publish/publishArticle/'+id,
			data:$("form").serialize(),
			success:function(data){
				if(data.status==1){
					alert('发布成功');
					form1.action = "sale_publish";
					form1.submit();
					return true;
				} else {
					alert('发布失败：'+data.msg);
				}
				$('[name="old_password"]').val('');
				$('[name="new_password"]').val('');
				$('[name="new_password2"]').val('');
			},
			error:function(html){
				var flag = (typeof console != 'undefined');
				if(flag) console.log("服务器忙，提交数据失败，代码:" +html.status+ "，请联系管理员！");
				alert("服务器忙，提交数据失败，请联系管理员！");
			}
		});

		return false;
	}

</script>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Target Material Design Bootstrap Admin Template</title>

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="${BASE_PATH }static/backend/assets/materialize/css/materialize.min.css" media="screen,projection" />
	<!-- Bootstrap Styles-->
	<link href="${BASE_PATH }static/backend/assets/css/bootstrap.css" rel="stylesheet" />
	<!-- FontAwesome Styles-->
	<link href="${BASE_PATH }static/backend/assets/css/font-awesome.css" rel="stylesheet" />
	<!-- Morris Chart Styles-->
	<link href="${BASE_PATH }static/backend/assets/js/morris/morris-0.4.3.min.css" rel="stylesheet" />
	<!-- Custom Styles-->
	<link href="${BASE_PATH }static/backend/assets/css/custom-styles.css" rel="stylesheet" />
	<!-- Google Fonts-->
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
	<link rel="${BASE_PATH }static/backend/stylesheet" href="assets/js/Lightweight-Chart/cssCharts.css">
</head>
<body>
<div id="wrapper">
	<nav class="navbar navbar-default top-navbar" role="navigation">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand waves-effect waves-dark" href="index.html"><i class="large material-icons">track_changes</i> <strong>特卖区</strong></a>

			<div id="sideNav" href=""><i class="material-icons dp48">toc</i></div>
		</div>
	<!--右侧菜单列表-->
	<ul class="nav navbar-top-links navbar-right">
		<li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown1"><i class="fa fa-user fa-fw"></i> <b>John Doe</b> <i class="material-icons right">arrow_drop_down</i></a></li>
	</ul>
	</nav>
	<!-- Dropdown Structure -->
	<ul id="dropdown1" class="dropdown-content">
		<li><a href="#"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
		</li>
	</ul>


	<!--左侧菜单  -->
	<nav class="navbar-default navbar-side" role="navigation">
		<div class="sidebar-collapse">
			<ul class="nav" id="main-menu">

				<li>
					<a href="../admin" class="waves-effect waves-dark"><i class="fa fa-dashboard"></i> 信息统计</a>
				</li>
				<li>
					<a href="sale_publish" class="active-menu waves-effect waves-dark"><i class="fa fa-desktop"></i> 特卖区发布信息</a>
				</li>
			</ul>
		</div>
	</nav>
	<!-- /. NAV SIDE  -->
	<!--菜单栏+右中内容的大盒子-->
	<div id="page-wrapper">
		<div class="header">
			<h1 class="page-header">
				特卖区发布信息
			</h1>
			<ol class="breadcrumb">
				<li><a href="../admin">首页</a></li>
				<li><a href="sale_publish">特卖区 </a></li>
			</ol>
		</div>
		<!--666-->
		<div id="page-inner">

			<div class="row">
				<div class="col-lg-12">
					<div class="card">
						<div class="card-action">
							发布信息
						</div>
						<div class="card-content">
							<form class="form-horizontal" name="form1" action="" method="post">
								<input type="hidden" name="model.id" class="form-control" id="model.id"
									   value="${model.id!'0'}">
								<div class="row">
									<div class="form-group">
										<label for="model.album_id" class="col-sm-2 control-label">栏目</label>
										<div class="col-sm-10" >
											<select  class="form-control" name="model.album_id">
												<option value="-1">--请选择栏目--</option>
												<%
												if(!isEmpty(albums)) {
												for(item in albums){ %>
												<option value="${item.id}" ${item.id==model.album_id!0?'selected':''} >${item.name}</option>
												<%
												}
												}
												%>
											</select>
										</div>
									</div>

									<div class="form-group">
										<label for="model.name" class="col-sm-2 control-label">标题</label>
										<div class="col-sm-10">
											<input name="model.name" class="form-control" id="model.name"
												   value="${model.name!''}" placeholder="标题">
										</div>
									</div>

									<div class="form-group">
										<label for="model.property" class="col-sm-2 control-label">属性</label>
										<div class="col-sm-10">
											<input name="model.property" class="form-control" id="model.property"
												   value="${model.property!''}" placeholder="属性">
										</div>
									</div>

									<div class="form-group">
										<label for="model.price" class="col-sm-2 control-label">价格</label>
										<div class="col-sm-10">
											<input name="model.price" class="form-control" id="model.price"
												   value="${model.price!''}" placeholder="价格">
										</div>
									</div>
									<div class="form-group">
										<label for="model.num" class="col-sm-2 control-label">数量</label>
										<div class="col-sm-10">
											<input name="model.num" class="form-control" id="model.num"
												   value="${model.num!''}" placeholder="数量">
										</div>
									</div>
									<div class="form-group">
										<label for="model.unit" class="col-sm-2 control-label">单位</label>
										<div class="col-sm-10">
											<input name="model.unit" class="form-control" id="model.unit"
												   value="${model.unit!''}" placeholder="单位">
										</div>
									</div>

									<div class="form-group">
										<label for="model.unit" class="col-sm-2 control-label">封面图片</label>
										<div class="col-sm-10">
											<!--网络图片地址-->
											<label>方法一:</label>
											<!--class="form-control"-->
											<input type="text" accept="image/*"  name="model.image_net_url"
												   id="model.image_net_url" placeholder="输入网络图片链接"/>
											<!--<input name="model.unit" class="form-control" id="model.unit"
												   value="${model.unit!''}" placeholder="上传封面图片">-->
											<!--上传本地图片-->
											<label>方法二:</label>
											<input type="file" accept="image/*" class="form-control" name="model.image_url"
												   id="model.image_url"/>
											<!--<input name="model.unit" class="form-control" id="model.unit"
												   value="${model.unit!''}" placeholder="上传封面图片">-->
										</div>
									</div>

									<div class="form-group">
										<label for="remark" class="col-sm-2 control-label">内容</label>
										<div class="col-sm-10">
											<script id="editor" type="text/plain" name="model.content"
													style="width: 98%; height: 320px;">${model.content!''}</script>
										</div>
									 </div>
								</div>

								<div class="form-group">
								    <div class="col-sm-offset-3 col-sm-9">
									    <div class="checkbox">
									        <label>
									         <input type="button" value="确认发布"  class="waves-effect waves-light btn-large" onclick="oper_publish(${model.id!'0'});"/>&nbsp;
									          <input type="button" value="保存草稿箱"  class="waves-effect waves-light btn-large" onclick="oper_savedraft(${model.id!'0'});"/>
									        </label>
										</div>
									</div>
								</div>
							</div>
						</form>
						<div class="clearBoth"></div>

					</div>

				</div>
			</div>
		</div>

	</div><!-- /. PAGE WRAPPER  -->

</div>
<!-- /. WRAPPER  -->
<!-- JS Scripts-->
<!-- jQuery Js -->
<script src="${BASE_PATH }static/backend/assets/js/jquery-1.10.2.js"></script>

<!-- Bootstrap Js -->
<script src="${BASE_PATH }static/backend/assets/js/bootstrap.min.js"></script>

<script src="${BASE_PATH }static/backend/assets/materialize/js/materialize.min.js"></script>

<!-- Metis Menu Js -->
<script src="${BASE_PATH }static/backend/assets/js/jquery.metisMenu.js"></script>
<!-- Morris Chart Js -->
<script src="${BASE_PATH }static/backend/assets/js/morris/raphael-2.1.0.min.js"></script>
<script src="${BASE_PATH }static/backend/assets/js/morris/morris.js"></script>


<script src="${BASE_PATH }static/backend/assets/js/easypiechart.js"></script>
<script src="${BASE_PATH }static/backend/assets/js/easypiechart-data.js"></script>

<script src="${BASE_PATH }static/backend/assets/js/Lightweight-Chart/jquery.chart.js"></script>

<!-- Custom Js -->
<script src="${BASE_PATH }static/backend/assets/js/custom-scripts.js"></script>


</body>

</html>
